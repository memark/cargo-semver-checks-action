name: magnus-test

on:
  push: {}

env:
  RUST_BACKTRACE: 1

jobs:
  job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the test repository with patch change and patch version bump
        uses: actions/checkout@v4
        with:
          repository: mgr0dzicki/cargo-semver-action-ref-slice
          ref: patch_change
          persist-credentials: true

      - name: Checkout the action
        uses: actions/checkout@v4
        with:
          path: action

      - name: Run the action - toolchain empty
        uses: ./action/
        with:
          prefix-key: 1

      - name: Run the action - toolchain stable
        uses: ./action/
        with:
          rust-toolchain: stable
          prefix-key: 2
        continue-on-error: true

      - name: Run the action - toolchain manual
        uses: ./action/
        with:
          rust-toolchain: manual
          prefix-key: 3
        continue-on-error: true

      - name: Run the action - toolchain stable + target
        uses: ./action/
        with:
          rust-toolchain: stable
          rust-target: aarch64-apple-darwin
          prefix-key: 4
        continue-on-error: true
      
      - name: Run the action - toolchain manual + target
        uses: ./action/
        with:
          rust-toolchain: manual
          rust-target: aarch64-apple-darwin
          prefix-key: 5
        continue-on-error: true
